variables:
  PIPELINE_NAME: Pipeline

workflow:
  name: $PIPELINE_NAME
  rules:
    - if: $CI_COMMIT_TAG
      variables:
        PIPELINE_NAME: Publishing $CI_COMMIT_TAG

stages:
  - publish

publish-composer:
  stage: publish
  image: alpine:3.18
  script:
    - apk add curl
    - 'curl --header "Job-Token: $CI_JOB_TOKEN" --data tag=$CI_COMMIT_TAG "${CI_API_V4_URL}/projects/$CI_PROJECT_ID/packages/composer"'
  only:
    - tags
